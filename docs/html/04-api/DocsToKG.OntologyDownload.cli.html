

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1. Module: cli &mdash; DocsToKG 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            DocsToKG
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../01-overview/index.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-setup/index.html">1. Setup Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03-architecture/index.html">1. Architecture Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">1. API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05-development/index.html">1. Development Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06-operations/index.html">1. Operations Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07-reference/index.html">1. Technical Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DocsToKG</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">1. Module: cli</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/04-api/DocsToKG.OntologyDownload.cli.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-cli">
<h1>1. Module: cli<a class="headerlink" href="#module-cli" title="Link to this heading"></a></h1>
<p>This reference documents the DocsToKG module <code class="docutils literal notranslate"><span class="pre">DocsToKG.OntologyDownload.cli</span></code>.</p>
<p>Ontology downloader CLI entry points.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ontofetch</span></code> command exposes planning, pull, validation, diagnostics, and
storage management workflows described in the ontology download refactor.
Operators can override concurrency and host allowlists from the CLI, diff plan
outputs, prune historical versions, and run comprehensive <code class="docutils literal notranslate"><span class="pre">doctor</span></code> diagnostics
without editing configuration files. JSON output modes support automation while
rich ASCII tables summarise resolver fallback chains and validator results.</p>
<section id="functions">
<h2>1. Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h2>
<section id="build-parser">
<h3><code class="docutils literal notranslate"><span class="pre">_build_parser()</span></code><a class="headerlink" href="#build-parser" title="Link to this heading"></a></h3>
<p>Configure the top-level CLI parser and subcommands.</p>
</section>
<section id="parse-target-formats-value">
<h3><code class="docutils literal notranslate"><span class="pre">_parse_target_formats(value)</span></code><a class="headerlink" href="#parse-target-formats-value" title="Link to this heading"></a></h3>
<p>Normalize comma-separated target format strings.</p>
<p>Args:
value: Raw CLI argument possibly containing comma-delimited formats.</p>
<p>Returns:
List of stripped format identifiers, or an empty list when no formats are supplied.</p>
</section>
<section id="parse-positive-int-value">
<h3><code class="docutils literal notranslate"><span class="pre">_parse_positive_int(value)</span></code><a class="headerlink" href="#parse-positive-int-value" title="Link to this heading"></a></h3>
<p>Parse CLI argument ensuring it is a positive integer.</p>
</section>
<section id="parse-allowed-hosts-value">
<h3><code class="docutils literal notranslate"><span class="pre">_parse_allowed_hosts(value)</span></code><a class="headerlink" href="#parse-allowed-hosts-value" title="Link to this heading"></a></h3>
<p>Split comma-delimited host allowlist argument into unique entries.</p>
</section>
<section id="normalize-plan-args-args">
<h3><code class="docutils literal notranslate"><span class="pre">_normalize_plan_args(args)</span></code><a class="headerlink" href="#normalize-plan-args-args" title="Link to this heading"></a></h3>
<p>Ensure <code class="docutils literal notranslate"><span class="pre">plan</span></code> command defaults to the <code class="docutils literal notranslate"><span class="pre">run</span></code> subcommand when omitted.</p>
</section>
<section id="parse-since-arg-value">
<h3><code class="docutils literal notranslate"><span class="pre">_parse_since_arg(value)</span></code><a class="headerlink" href="#parse-since-arg-value" title="Link to this heading"></a></h3>
<p>Argparse hook parsing YYYY-MM-DD strings into timezone-aware datetimes.</p>
</section>
<section id="parse-since-value">
<h3><code class="docutils literal notranslate"><span class="pre">_parse_since(value)</span></code><a class="headerlink" href="#parse-since-value" title="Link to this heading"></a></h3>
<p>Parse optional date input into timezone-aware datetimes.</p>
</section>
<section id="format-bytes-num">
<h3><code class="docutils literal notranslate"><span class="pre">_format_bytes(num)</span></code><a class="headerlink" href="#format-bytes-num" title="Link to this heading"></a></h3>
<p>Return human-readable byte count representation.</p>
</section>
<section id="directory-size-path">
<h3><code class="docutils literal notranslate"><span class="pre">_directory_size(path)</span></code><a class="headerlink" href="#directory-size-path" title="Link to this heading"></a></h3>
<p>Return the cumulative size of files under <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p>
</section>
<section id="parse-version-timestamp-value">
<h3><code class="docutils literal notranslate"><span class="pre">_parse_version_timestamp(value)</span></code><a class="headerlink" href="#parse-version-timestamp-value" title="Link to this heading"></a></h3>
<p>Parse version or manifest timestamps into UTC datetimes.</p>
</section>
<section id="apply-cli-overrides-config-args">
<h3><code class="docutils literal notranslate"><span class="pre">_apply_cli_overrides(config,</span> <span class="pre">args)</span></code><a class="headerlink" href="#apply-cli-overrides-config-args" title="Link to this heading"></a></h3>
<p>Mutate resolved configuration based on CLI override arguments.</p>
</section>
<section id="rate-limit-to-rps-value">
<h3><code class="docutils literal notranslate"><span class="pre">_rate_limit_to_rps(value)</span></code><a class="headerlink" href="#rate-limit-to-rps-value" title="Link to this heading"></a></h3>
<p>Convert rate limit string into requests-per-second float.</p>
</section>
<section id="results-to-dict-result">
<h3><code class="docutils literal notranslate"><span class="pre">_results_to_dict(result)</span></code><a class="headerlink" href="#results-to-dict-result" title="Link to this heading"></a></h3>
<p>Convert a <code class="docutils literal notranslate"><span class="pre">FetchResult</span></code> instance into a JSON-friendly mapping.</p>
<p>Args:
result: Completed fetch result returned by :func:<code class="docutils literal notranslate"><span class="pre">fetch_one</span></code>.</p>
<p>Returns:
Dictionary containing resolver metadata, manifest location, and artifact list.</p>
</section>
<section id="compute-plan-diff-baseline-current">
<h3><code class="docutils literal notranslate"><span class="pre">_compute_plan_diff(baseline,</span> <span class="pre">current)</span></code><a class="headerlink" href="#compute-plan-diff-baseline-current" title="Link to this heading"></a></h3>
<p>Compute additions, removals, and modifications between plan snapshots.</p>
</section>
<section id="format-plan-diff-diff">
<h3><code class="docutils literal notranslate"><span class="pre">_format_plan_diff(diff)</span></code><a class="headerlink" href="#format-plan-diff-diff" title="Link to this heading"></a></h3>
<p>Render human-readable diff lines from plan comparison.</p>
</section>
<section id="plan-to-dict-plan">
<h3><code class="docutils literal notranslate"><span class="pre">_plan_to_dict(plan)</span></code><a class="headerlink" href="#plan-to-dict-plan" title="Link to this heading"></a></h3>
<p>Convert a planned fetch into a JSON-friendly dictionary.</p>
<p>Args:
plan: Planned fetch data produced by :func:<code class="docutils literal notranslate"><span class="pre">plan_one</span></code> or :func:<code class="docutils literal notranslate"><span class="pre">plan_all</span></code>.</p>
<p>Returns:
Mapping containing resolver metadata and planned download details suitable
for serialization.</p>
</section>
<section id="parse-iso-datetime-value">
<h3><code class="docutils literal notranslate"><span class="pre">_parse_iso_datetime(value)</span></code><a class="headerlink" href="#parse-iso-datetime-value" title="Link to this heading"></a></h3>
<p>Parse ISO formatted date strings into timezone-aware datetimes.</p>
</section>
<section id="parse-http-datetime-value">
<h3><code class="docutils literal notranslate"><span class="pre">_parse_http_datetime(value)</span></code><a class="headerlink" href="#parse-http-datetime-value" title="Link to this heading"></a></h3>
<p>Parse HTTP header datetime strings into timezone-aware datetimes.</p>
</section>
<section id="extract-response-metadata-response">
<h3><code class="docutils literal notranslate"><span class="pre">_extract_response_metadata(response)</span></code><a class="headerlink" href="#extract-response-metadata-response" title="Link to this heading"></a></h3>
<p>Return structured metadata from an HTTP response.</p>
</section>
<section id="collect-plan-metadata-plans-config">
<h3><code class="docutils literal notranslate"><span class="pre">_collect_plan_metadata(plans,</span> <span class="pre">config)</span></code><a class="headerlink" href="#collect-plan-metadata-plans-config" title="Link to this heading"></a></h3>
<p>Augment planned fetches with remote metadata via HEAD requests.</p>
</section>
<section id="directory-size-bytes-path">
<h3><code class="docutils literal notranslate"><span class="pre">_directory_size_bytes(path)</span></code><a class="headerlink" href="#directory-size-bytes-path" title="Link to this heading"></a></h3>
<p>Return the cumulative size of files within <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p>
</section>
<section id="infer-version-timestamp-version">
<h3><code class="docutils literal notranslate"><span class="pre">_infer_version_timestamp(version)</span></code><a class="headerlink" href="#infer-version-timestamp-version" title="Link to this heading"></a></h3>
<p>Attempt to derive a datetime from a version string.</p>
</section>
<section id="resolve-version-metadata-ontology-id-version">
<h3><code class="docutils literal notranslate"><span class="pre">_resolve_version_metadata(ontology_id,</span> <span class="pre">version)</span></code><a class="headerlink" href="#resolve-version-metadata-ontology-id-version" title="Link to this heading"></a></h3>
<p>Return path, timestamp, and size metadata for a stored version.</p>
</section>
<section id="ensure-manifest-path-ontology-id-version">
<h3><code class="docutils literal notranslate"><span class="pre">_ensure_manifest_path(ontology_id,</span> <span class="pre">version)</span></code><a class="headerlink" href="#ensure-manifest-path-ontology-id-version" title="Link to this heading"></a></h3>
<p>Return the manifest path for a given ontology and version.</p>
<p>Args:
ontology_id: Identifier for the ontology whose manifest is requested.
version: Optional version string; when omitted the latest available is used.</p>
<p>Returns:
Path to the manifest JSON file on disk.</p>
<p>Raises:
ConfigError: If the ontology or manifest cannot be located locally.</p>
</section>
<section id="load-manifest-manifest-path">
<h3><code class="docutils literal notranslate"><span class="pre">_load_manifest(manifest_path)</span></code><a class="headerlink" href="#load-manifest-manifest-path" title="Link to this heading"></a></h3>
<p>Read and parse a manifest JSON document from disk.</p>
<p>Args:
manifest_path: Filesystem location of the manifest file.</p>
<p>Returns:
Dictionary representation of the manifest contents.</p>
</section>
<section id="collect-version-metadata-ontology-id">
<h3><code class="docutils literal notranslate"><span class="pre">_collect_version_metadata(ontology_id)</span></code><a class="headerlink" href="#collect-version-metadata-ontology-id" title="Link to this heading"></a></h3>
<p>Return sorted metadata entries for stored ontology versions.</p>
</section>
<section id="update-latest-symlink-ontology-id-target">
<h3><code class="docutils literal notranslate"><span class="pre">_update_latest_symlink(ontology_id,</span> <span class="pre">target)</span></code><a class="headerlink" href="#update-latest-symlink-ontology-id-target" title="Link to this heading"></a></h3>
<p>Ensure latest marker references the provided target directory.</p>
</section>
<section id="resolve-specs-from-args-args-base-config">
<h3><code class="docutils literal notranslate"><span class="pre">_resolve_specs_from_args(args,</span> <span class="pre">base_config)</span></code><a class="headerlink" href="#resolve-specs-from-args-args-base-config" title="Link to this heading"></a></h3>
<p>Return configuration and fetch specifications derived from CLI arguments.</p>
<p>Args:
args: Parsed command-line arguments for <code class="docutils literal notranslate"><span class="pre">pull</span></code>/<code class="docutils literal notranslate"><span class="pre">plan</span></code> commands.
base_config: Optional pre-loaded configuration used when no spec file is supplied.</p>
<p>Returns:
Tuple containing the active resolved configuration and the list of fetch specs
that should be processed.</p>
<p>Raises:
ConfigError: If neither explicit IDs nor a configuration file are provided.</p>
</section>
<section id="handle-pull-args-base-config">
<h3><code class="docutils literal notranslate"><span class="pre">_handle_pull(args,</span> <span class="pre">base_config)</span></code><a class="headerlink" href="#handle-pull-args-base-config" title="Link to this heading"></a></h3>
<p>Execute the <code class="docutils literal notranslate"><span class="pre">pull</span></code> subcommand workflow.</p>
</section>
<section id="handle-plan-args-base-config">
<h3><code class="docutils literal notranslate"><span class="pre">_handle_plan(args,</span> <span class="pre">base_config)</span></code><a class="headerlink" href="#handle-plan-args-base-config" title="Link to this heading"></a></h3>
<p>Resolve plans without executing downloads.</p>
</section>
<section id="handle-plan-diff-args-base-config">
<h3><code class="docutils literal notranslate"><span class="pre">_handle_plan_diff(args,</span> <span class="pre">base_config)</span></code><a class="headerlink" href="#handle-plan-diff-args-base-config" title="Link to this heading"></a></h3>
<p>Compare current plan output against a baseline plan file.</p>
</section>
<section id="handle-prune-args-logger">
<h3><code class="docutils literal notranslate"><span class="pre">_handle_prune(args,</span> <span class="pre">logger)</span></code><a class="headerlink" href="#handle-prune-args-logger" title="Link to this heading"></a></h3>
<p>Delete surplus ontology versions based on <code class="docutils literal notranslate"><span class="pre">--keep</span></code> parameter.</p>
</section>
<section id="doctor-report">
<h3><code class="docutils literal notranslate"><span class="pre">_doctor_report()</span></code><a class="headerlink" href="#doctor-report" title="Link to this heading"></a></h3>
<p>Collect diagnostic information for the <code class="docutils literal notranslate"><span class="pre">doctor</span></code> command.</p>
</section>
<section id="print-doctor-report-report">
<h3><code class="docutils literal notranslate"><span class="pre">_print_doctor_report(report)</span></code><a class="headerlink" href="#print-doctor-report-report" title="Link to this heading"></a></h3>
<p>Render human-readable diagnostics from :func:<code class="docutils literal notranslate"><span class="pre">_doctor_report</span></code>.</p>
<p>Args:
report: Diagnostics mapping generated by :func:<code class="docutils literal notranslate"><span class="pre">_doctor_report</span></code>.</p>
</section>
<section id="handle-show-args">
<h3><code class="docutils literal notranslate"><span class="pre">_handle_show(args)</span></code><a class="headerlink" href="#handle-show-args" title="Link to this heading"></a></h3>
<p>Display ontology manifest information for the <code class="docutils literal notranslate"><span class="pre">show</span></code> command.</p>
<p>Args:
args: Parsed CLI arguments including ontology identifier and output format.</p>
<p>Returns:
None</p>
<p>Raises:
ConfigError: When the manifest cannot be located.</p>
</section>
<section id="selected-validators-args">
<h3><code class="docutils literal notranslate"><span class="pre">_selected_validators(args)</span></code><a class="headerlink" href="#selected-validators-args" title="Link to this heading"></a></h3>
<p>Determine which validators should execute based on CLI flags.</p>
<p>Args:
args: Parsed CLI arguments for the <code class="docutils literal notranslate"><span class="pre">validate</span></code> command.</p>
<p>Returns:
Sequence containing validator names in execution order.</p>
</section>
<section id="handle-validate-args-config">
<h3><code class="docutils literal notranslate"><span class="pre">_handle_validate(args,</span> <span class="pre">config)</span></code><a class="headerlink" href="#handle-validate-args-config" title="Link to this heading"></a></h3>
<p>Run validators for a previously downloaded ontology.</p>
<p>Args:
args: Parsed CLI arguments specifying ontology ID, version, and output format.
config: Resolved configuration supplying validator defaults.</p>
<p>Returns:
Mapping of validator names to their structured result payloads.</p>
<p>Raises:
ConfigError: If the manifest or downloaded artifacts cannot be located.</p>
</section>
<section id="handle-init-path">
<h3><code class="docutils literal notranslate"><span class="pre">_handle_init(path)</span></code><a class="headerlink" href="#handle-init-path" title="Link to this heading"></a></h3>
<p>Create a starter <code class="docutils literal notranslate"><span class="pre">sources.yaml</span></code> file for new installations.</p>
<p>Args:
path: Destination path for the generated configuration template.</p>
<p>Returns:
None</p>
<p>Raises:
ConfigError: If the target file already exists.</p>
</section>
<section id="handle-config-validate-path">
<h3><code class="docutils literal notranslate"><span class="pre">_handle_config_validate(path)</span></code><a class="headerlink" href="#handle-config-validate-path" title="Link to this heading"></a></h3>
<p>Validate a configuration file and return a summary report.</p>
<p>Args:
path: Filesystem path to the configuration file under validation.</p>
<p>Returns:
Dictionary describing validation status, ontology count, and file path.</p>
</section>
<section id="normalize-argv-argv">
<h3><code class="docutils literal notranslate"><span class="pre">_normalize_argv(argv)</span></code><a class="headerlink" href="#normalize-argv-argv" title="Link to this heading"></a></h3>
<p>Rewrite legacy aliases to the canonical subcommand syntax.</p>
</section>
<section id="main-argv">
<h3><code class="docutils literal notranslate"><span class="pre">main(argv)</span></code><a class="headerlink" href="#main-argv" title="Link to this heading"></a></h3>
<p>Entry point for the ontology downloader CLI.</p>
<p>Args:
argv: Optional argument vector supplied for testing or scripting.</p>
<p>Returns:
Process exit code indicating success (<code class="docutils literal notranslate"><span class="pre">0</span></code>) or failure.</p>
<p>Raises:
ConfigError: If configuration files are invalid or unsafe to overwrite.
OntologyDownloadError: If download or validation operations fail.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, DocsToKG Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>