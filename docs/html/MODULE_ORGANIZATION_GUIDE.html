

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1. Module Organization and Navigation Guide &mdash; DocsToKG 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />


      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=8d563738"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
</head>

<body class="wy-body-for-nav">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >



          <a href="index.html" class="icon icon-home">
            DocsToKG
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="01-overview/index.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="02-setup/index.html">1. Setup Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-architecture/index.html">1. Architecture Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="04-api/index.html">1. API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="05-development/index.html">1. Development Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="06-operations/index.html">1. Operations Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="07-reference/index.html">1. Technical Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DocsToKG</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">1. Module Organization and Navigation Guide</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/MODULE_ORGANIZATION_GUIDE.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <section id="module-organization-and-navigation-guide">
<h1>1. Module Organization and Navigation Guide<a class="headerlink" href="#module-organization-and-navigation-guide" title="Link to this heading"></a></h1>
<p>This guide defines how source files should be structured so that classes, functions,
and helpers are easy to discover, maintain, and document. The conventions pair with
the NAVMAP metadata described in <code class="docutils literal notranslate"><span class="pre">CODE_ANNOTATION_STANDARDS.md</span></code> and are intended to
keep the DocsToKG codebase coherent as it grows.</p>
<section id="purpose">
<h2>2. Purpose<a class="headerlink" href="#purpose" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Create predictable ordering within every module so contributors know where to add
new logic.</p></li>
<li><p>Support automated agents and documentation tooling by exposing consistent section
boundaries.</p></li>
<li><p>Reduce merge conflicts and code drift by keeping related functionality clustered.</p></li>
</ul>
</section>
<section id="core-principles">
<h2>3. Core Principles<a class="headerlink" href="#core-principles" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p><strong>Group by responsibility, not chronology.</strong> Keep related behaviour together even
if it was authored at different times.</p></li>
<li><p><strong>Prefer narrow modules.</strong> When a file exceeds ~500 lines or mixes unrelated
responsibilities, split the content into focused submodules.</p></li>
<li><p><strong>Document the layout.</strong> Every module must contain a NAVMAP block that mirrors the
clusters defined below so automation can navigate the file.</p></li>
<li><p><strong>Keep public APIs forward.</strong> Readers should encounter the main entry points before
the private helpers that implement them.</p></li>
<li><p><strong>Minimise cross-module leakage.</strong> Share utilities through dedicated helper
modules instead of letting unrelated files import deep internals.</p></li>
</ol>
</section>
<section id="standard-ordering-convention">
<h2>4. Standard Ordering Convention<a class="headerlink" href="#standard-ordering-convention" title="Link to this heading"></a></h2>
<p>Every module should follow this ordering unless a documented exception exists:</p>
<ol class="arabic simple">
<li><p><strong>Module metadata.</strong></p>
<ul class="simple">
<li><p>NAVMAP block</p></li>
<li><p>Module docstring</p></li>
<li><p>Module-level constants, feature flags, and type aliases</p></li>
</ul>
</li>
<li><p><strong>Public classes and dataclasses.</strong></p>
<ul class="simple">
<li><p>Place the primary orchestrator class first</p></li>
<li><p>Follow with supporting data carriers (configs, payloads, results)</p></li>
</ul>
</li>
<li><p><strong>Public functions.</strong></p>
<ul class="simple">
<li><p>Entry points that external callers import directly</p></li>
<li><p>Keep high-level factory functions near related classes</p></li>
</ul>
</li>
<li><p><strong>Private helpers.</strong></p>
<ul class="simple">
<li><p>Pure helpers grouped by the public API they serve</p></li>
<li><p>I/O helpers together, transformation helpers together, etc.</p></li>
</ul>
</li>
<li><p><strong>Module entry hooks.</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">&quot;__main__&quot;:</span></code> blocks</p></li>
<li><p>CLI registration, plugin exports, or framework bindings</p></li>
</ul>
</li>
</ol>
<p>When a module spans multiple feature clusters (for example CLI command groups versus
shared utilities), carve the helpers into clearly labelled sections using inline
comment dividers (for example <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">---</span> <span class="pre">CLI</span> <span class="pre">Command</span> <span class="pre">Handlers</span> <span class="pre">---</span></code>).</p>
</section>
<section id="navigation-metadata-navmap">
<h2>5. Navigation Metadata (NAVMAP)<a class="headerlink" href="#navigation-metadata-navmap" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Add a single NAVMAP block at the top of each module describing the major sections.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">sections</span></code> entries to match the ordering convention and provide anchors
(for example <code class="docutils literal notranslate"><span class="pre">&quot;anchor&quot;:</span> <span class="pre">&quot;CLI&quot;</span></code> for command handlers).</p></li>
<li><p>Ensure the NAVMAP order matches the physical layout so tooling can jump to the
right block when generating documentation or performing refactors.</p></li>
<li><p>Update the NAVMAP whenever sections move, names change, or new clusters are added.</p></li>
</ul>
<section id="navmap-example">
<h3>5.1 NAVMAP Example<a class="headerlink" href="#navmap-example" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># === NAVMAP v1 ===</span>
<span class="c1"># {</span>
<span class="c1">#   &quot;module&quot;: &quot;src.DocParsing.cli&quot;,</span>
<span class="c1">#   &quot;purpose&quot;: &quot;CLI entry points for document parsing workflows&quot;,</span>
<span class="c1">#   &quot;sections&quot;: [</span>
<span class="c1">#     {&quot;id&quot;: &quot;imports&quot;, &quot;name&quot;: &quot;Imports and Globals&quot;, &quot;anchor&quot;: &quot;imports&quot;, &quot;kind&quot;: &quot;infra&quot;},</span>
<span class="c1">#     {&quot;id&quot;: &quot;commands&quot;, &quot;name&quot;: &quot;CLI Commands&quot;, &quot;anchor&quot;: &quot;cli&quot;, &quot;kind&quot;: &quot;api&quot;},</span>
<span class="c1">#     {&quot;id&quot;: &quot;helpers&quot;, &quot;name&quot;: &quot;Command Helpers&quot;, &quot;anchor&quot;: &quot;helpers&quot;, &quot;kind&quot;: &quot;internal&quot;}</span>
<span class="c1">#   ]</span>
<span class="c1"># }</span>
<span class="c1"># === /NAVMAP ===</span>
</pre></div>
</div>
<p>Keep the JSON compact (two-space indentation) and ensure every section listed here
exists in the file with a matching heading.</p>
</section>
</section>
<section id="formatting-requirements">
<h2>6. Formatting Requirements<a class="headerlink" href="#formatting-requirements" title="Link to this heading"></a></h2>
<section id="section-divider-format">
<h3>6.1 Section Divider Format<a class="headerlink" href="#section-divider-format" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Start each major cluster with a comment divider using three components:
<code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">---</span> <span class="pre">&lt;Section</span> <span class="pre">Name&gt;</span> <span class="pre">---</span></code>.</p></li>
<li><p>Leave a single blank line between the divider and the first definition.</p></li>
<li><p>Use matching casing between the divider, NAVMAP <code class="docutils literal notranslate"><span class="pre">name</span></code>, and any related comments so
automation can verify alignment.</p></li>
</ul>
</section>
<section id="imports-exports-and-constants">
<h3>6.2 Imports, Exports, and Constants<a class="headerlink" href="#imports-exports-and-constants" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Imports appear immediately after the module docstring and should follow the standard
library → third-party → local ordering.</p></li>
<li><p>Declare <code class="docutils literal notranslate"><span class="pre">__all__</span></code> alongside other module-level constants to surface the intended
public API. Keep the tuple/list alphabetised to match the order of public classes
and functions defined later in the module.</p></li>
<li><p>Group related constants together beneath a <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">---</span> <span class="pre">Configuration</span> <span class="pre">---</span></code> divider when
there are more than three items.</p></li>
</ul>
</section>
<section id="matching-navmap-to-physical-layout">
<h3>6.3 Matching NAVMAP to Physical Layout<a class="headerlink" href="#matching-navmap-to-physical-layout" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>The section order in NAVMAP must match the physical order of the divider comments.</p></li>
<li><p>Avoid creating NAVMAP entries for single functions unless they represent a meaningful
section (for example a command group in the CLI module).</p></li>
<li><p>When removing a section from a module, delete the corresponding NAVMAP entry in the
same change set to prevent stale navigation metadata.</p></li>
</ul>
</section>
</section>
<section id="module-skeleton-example">
<h2>7. Module Skeleton Example<a class="headerlink" href="#module-skeleton-example" title="Link to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># === NAVMAP v1 ===</span>
<span class="c1"># {</span>
<span class="c1">#   &quot;module&quot;: &quot;src.DocParsing.example&quot;,</span>
<span class="c1">#   &quot;purpose&quot;: &quot;Illustrative template for module organisation&quot;,</span>
<span class="c1">#   &quot;sections&quot;: [</span>
<span class="c1">#     {&quot;id&quot;: &quot;globals&quot;, &quot;name&quot;: &quot;Globals&quot;, &quot;anchor&quot;: &quot;globals&quot;, &quot;kind&quot;: &quot;infra&quot;},</span>
<span class="c1">#     {&quot;id&quot;: &quot;api&quot;, &quot;name&quot;: &quot;Public API&quot;, &quot;anchor&quot;: &quot;api&quot;, &quot;kind&quot;: &quot;api&quot;},</span>
<span class="c1">#     {&quot;id&quot;: &quot;helpers&quot;, &quot;name&quot;: &quot;Private Helpers&quot;, &quot;anchor&quot;: &quot;helpers&quot;, &quot;kind&quot;: &quot;internal&quot;}</span>
<span class="c1">#   ]</span>
<span class="c1"># }</span>
<span class="c1"># === /NAVMAP ===</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example Module</span>

<span class="sd">Short description of the module’s purpose and the workflows it supports.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># --- Globals ---</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;process_documents&quot;</span><span class="p">,</span> <span class="s2">&quot;DocumentProcessor&quot;</span><span class="p">)</span>
<span class="n">DEFAULT_BATCH_SIZE</span> <span class="o">=</span> <span class="mi">50</span>


<span class="c1"># --- Public API ---</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DocumentProcessor</span><span class="p">:</span>
    <span class="o">...</span>


<span class="k">def</span><span class="w"> </span><span class="nf">process_documents</span><span class="p">(</span><span class="n">doc_ids</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Result</span><span class="p">]:</span>
    <span class="o">...</span>


<span class="c1"># --- Private Helpers ---</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_parse_document</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParsedDocument</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>This skeleton demonstrates the ordering, divider format, and NAVMAP alignment required
for production modules.</p>
</section>
<section id="module-specific-guidance">
<h2>8. Module-Specific Guidance<a class="headerlink" href="#module-specific-guidance" title="Link to this heading"></a></h2>
<section id="docparsing-cli-py">
<h3>8.1. <code class="docutils literal notranslate"><span class="pre">DocParsing/cli.py</span></code><a class="headerlink" href="#docparsing-cli-py" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Start with CLI-specific constants, enums, and Click shared options.</p></li>
<li><p>Group command functions by user workflow (<code class="docutils literal notranslate"><span class="pre">ingest</span></code>, <code class="docutils literal notranslate"><span class="pre">process</span></code>, <code class="docutils literal notranslate"><span class="pre">export</span></code>).</p></li>
<li><p>Place shared helper routines (<code class="docutils literal notranslate"><span class="pre">_load_config</span></code>, <code class="docutils literal notranslate"><span class="pre">_print_summary</span></code>) immediately after
the command they support.</p></li>
<li><p>Move any reusable helpers into a future <code class="docutils literal notranslate"><span class="pre">cli_utils.py</span></code> if two or more commands use
them, and import those helpers near the top to avoid circular dependencies.</p></li>
</ol>
</section>
<section id="docparsing-pipelines-py">
<h3>8.2. <code class="docutils literal notranslate"><span class="pre">DocParsing/pipelines.py</span></code><a class="headerlink" href="#docparsing-pipelines-py" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Define pipeline configuration dataclasses first.</p></li>
<li><p>Follow with pipeline builder functions ordered by execution order
(<code class="docutils literal notranslate"><span class="pre">build_ingest_pipeline</span></code>, <code class="docutils literal notranslate"><span class="pre">build_transform_pipeline</span></code>, <code class="docutils literal notranslate"><span class="pre">build_emit_pipeline</span></code>).</p></li>
<li><p>Keep transformer/helper functions grouped under comment headers that match each
stage to avoid mixing ingest and emit logic.</p></li>
</ol>
</section>
<section id="docparsing-common-py-and-docparsing-schemas-py">
<h3>8.3. <code class="docutils literal notranslate"><span class="pre">DocParsing/_common.py</span></code> and <code class="docutils literal notranslate"><span class="pre">DocParsing/schemas.py</span></code><a class="headerlink" href="#docparsing-common-py-and-docparsing-schemas-py" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Begin with Pydantic models and enums.</p></li>
<li><p>Document validation helpers next, keeping synchronous and asynchronous utilities
in separate clusters.</p></li>
<li><p>Finish with serialization and conversion routines that depend on the earlier
definitions.</p></li>
</ol>
</section>
<section id="hybridsearch">
<h3>8.4. <code class="docutils literal notranslate"><span class="pre">HybridSearch/*</span></code><a class="headerlink" href="#hybridsearch" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">service.py</span></code> should open with the primary service class and public orchestration
functions, followed by scoring, request/response adapters, and finally private
helpers.</p></li>
<li><p>Keep storage- and FAISS-specific helpers in <code class="docutils literal notranslate"><span class="pre">storage.py</span></code> and <code class="docutils literal notranslate"><span class="pre">vectorstore.py</span></code>
rather than importing them into <code class="docutils literal notranslate"><span class="pre">service.py</span></code>.</p></li>
<li><p>Extract shared logging, metrics, and configuration adapters into <code class="docutils literal notranslate"><span class="pre">observability.py</span></code>
or <code class="docutils literal notranslate"><span class="pre">config.py</span></code> instead of duplicating them across modules.</p></li>
</ol>
</section>
<section id="ontologydownload">
<h3>8.5. <code class="docutils literal notranslate"><span class="pre">OntologyDownload/*</span></code><a class="headerlink" href="#ontologydownload" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Organise modules by workflow phase: request resolution, download execution,
normalization, validation, and storage.</p></li>
<li><p>Expose the module’s public entry point (<code class="docutils literal notranslate"><span class="pre">download_ontology</span></code>, <code class="docutils literal notranslate"><span class="pre">run_validators</span></code>)
immediately after constants.</p></li>
<li><p>Cluster subprocess, file system, and network helpers separately so changes in one
area do not require scanning the entire file.</p></li>
</ol>
</section>
</section>
<section id="supporting-modules-and-utilities">
<h2>9. Supporting Modules and Utilities<a class="headerlink" href="#supporting-modules-and-utilities" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Introduce <code class="docutils literal notranslate"><span class="pre">utils</span></code> modules only when three or more modules need the same helper.</p></li>
<li><p>Keep side-effect-heavy helpers (network, filesystem) separated from pure
transformations to simplify testing.</p></li>
<li><p>When creating a new helper module, add a NAVMAP and follow the standard ordering
convention so it remains discoverable.</p></li>
</ul>
</section>
<section id="tooling-and-automation">
<h2>10. Tooling and Automation<a class="headerlink" href="#tooling-and-automation" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Extend <code class="docutils literal notranslate"><span class="pre">docs/scripts/validate_code_annotations.py</span></code> to assert that each module
contains a NAVMAP block and that the sections are ordered according to the
convention above.</p></li>
<li><p>Update <code class="docutils literal notranslate"><span class="pre">generate_api_docs.py</span></code> to include section anchors when emitting Markdown so
the API reference mirrors the on-disk structure.</p></li>
<li><p>Add targeted unit tests for navigation helpers if we build automation that
rewrites files based on NAVMAP data.</p></li>
</ol>
</section>
<section id="rollout-strategy">
<h2>11. Rollout Strategy<a class="headerlink" href="#rollout-strategy" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p><strong>Document first.</strong> Socialise this guide and confirm buy-in from module owners.</p></li>
<li><p><strong>Template module.</strong> Apply the ordering and NAVMAP upgrades to a representative
module (<code class="docutils literal notranslate"><span class="pre">DocParsing/cli.py</span></code>) to gather feedback.</p></li>
<li><p><strong>Incremental refactor.</strong> Tackle modules in small batches, running the full test
suite and documentation pipeline after each batch.</p></li>
<li><p><strong>Automate enforcement.</strong> Enable the extended validation scripts once the majority
of modules adopt the layout to prevent regressions.</p></li>
<li><p><strong>Review cadence.</strong> Periodically audit large modules for drift and ensure new code
adheres to the established sections.</p></li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, DocsToKG Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

</body>
</html>
