{
  "description": "Archive extraction policy (safety, throughput, integrity).",
  "properties": {
    "casefold_collision_policy": {
      "default": "reject",
      "description": "Case collision policy (reject or allow)",
      "title": "Casefold Collision Policy",
      "type": "string"
    },
    "copy_buffer_max": {
      "default": 1048576,
      "description": "Max copy buffer bytes (1 MiB)",
      "minimum": 65536,
      "title": "Copy Buffer Max",
      "type": "integer"
    },
    "copy_buffer_min": {
      "default": 65536,
      "description": "Min copy buffer bytes (64 KiB)",
      "minimum": 1024,
      "title": "Copy Buffer Min",
      "type": "integer"
    },
    "duplicate_policy": {
      "default": "reject",
      "description": "Duplicate policy (reject, first_wins, last_wins)",
      "title": "Duplicate Policy",
      "type": "string"
    },
    "encapsulate": {
      "default": true,
      "description": "Extract in deterministic root",
      "title": "Encapsulate",
      "type": "boolean"
    },
    "encapsulation_name": {
      "default": "sha256",
      "description": "Encapsulation strategy (sha256 or basename)",
      "title": "Encapsulation Name",
      "type": "string"
    },
    "exclude_globs": {
      "description": "Exclude patterns",
      "items": {
        "type": "string"
      },
      "title": "Exclude Globs",
      "type": "array"
    },
    "group_fsync": {
      "default": 32,
      "description": "fsync directory every N files",
      "maximum": 1000,
      "minimum": 1,
      "title": "Group Fsync",
      "type": "integer"
    },
    "hash_algorithms": {
      "description": "Hash algorithms (e.g., sha256, sha1)",
      "items": {
        "type": "string"
      },
      "title": "Hash Algorithms",
      "type": "array"
    },
    "hash_enable": {
      "default": true,
      "description": "Compute file digests",
      "title": "Hash Enable",
      "type": "boolean"
    },
    "include_globs": {
      "description": "Include patterns (empty = all)",
      "items": {
        "type": "string"
      },
      "title": "Include Globs",
      "type": "array"
    },
    "max_components_len": {
      "default": 240,
      "description": "Max bytes per path component",
      "maximum": 4096,
      "minimum": 1,
      "title": "Max Components Len",
      "type": "integer"
    },
    "max_depth": {
      "default": 32,
      "description": "Max path depth",
      "maximum": 255,
      "minimum": 1,
      "title": "Max Depth",
      "type": "integer"
    },
    "max_entries": {
      "default": 50000,
      "description": "Max extractable entries",
      "maximum": 1000000,
      "minimum": 1,
      "title": "Max Entries",
      "type": "integer"
    },
    "max_entry_ratio": {
      "default": 100.0,
      "description": "Per-entry ratio cap",
      "maximum": 10000.0,
      "minimum": 1.0,
      "title": "Max Entry Ratio",
      "type": "number"
    },
    "max_file_size_bytes": {
      "default": 2147483648,
      "description": "Per-file size cap (2GB default)",
      "minimum": 1,
      "title": "Max File Size Bytes",
      "type": "integer"
    },
    "max_path_len": {
      "default": 4096,
      "description": "Max bytes per full path",
      "maximum": 32768,
      "minimum": 1,
      "title": "Max Path Len",
      "type": "integer"
    },
    "max_total_ratio": {
      "default": 10.0,
      "description": "Zip-bomb ratio (uncompressed/compressed)",
      "maximum": 1000.0,
      "minimum": 1.0,
      "title": "Max Total Ratio",
      "type": "number"
    },
    "max_wall_time_seconds": {
      "default": 120,
      "description": "Soft time budget per archive",
      "maximum": 3600,
      "minimum": 1,
      "title": "Max Wall Time Seconds",
      "type": "integer"
    },
    "overwrite": {
      "default": "reject",
      "description": "Overwrite policy (reject, replace, keep_existing)",
      "title": "Overwrite",
      "type": "string"
    },
    "preallocate": {
      "default": true,
      "description": "Preallocate files when size known",
      "title": "Preallocate",
      "type": "boolean"
    },
    "space_safety_margin": {
      "default": 1.1,
      "description": "Free-space headroom",
      "maximum": 10.0,
      "minimum": 1.0,
      "title": "Space Safety Margin",
      "type": "number"
    },
    "timestamps_mode": {
      "default": "preserve",
      "description": "Timestamp handling (preserve, normalize, source_date_epoch)",
      "title": "Timestamps Mode",
      "type": "string"
    },
    "timestamps_normalize_to": {
      "default": "archive_mtime",
      "description": "When normalizing: archive_mtime or now",
      "title": "Timestamps Normalize To",
      "type": "string"
    },
    "unicode_form": {
      "default": "NFC",
      "description": "Unicode normalization (NFC or NFD)",
      "title": "Unicode Form",
      "type": "string"
    }
  },
  "title": "ExtractionSettings",
  "type": "object"
}
